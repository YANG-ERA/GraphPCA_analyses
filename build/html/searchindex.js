Search.setIndex({"docnames": ["Installation", "Tutorial1_DLPFC", "Tutorial2_mPFC", "Tutorial3_Integration", "index"], "filenames": ["Installation.rst", "Tutorial1_DLPFC.ipynb", "Tutorial2_mPFC.ipynb", "Tutorial3_Integration.ipynb", "index.rst"], "titles": ["Installation", "Tutorial 1: 10X Visium dataset (DLPFC)", "Tutorial 2: STARmap data (mPFC)", "Tutorial 3: Multi-sample integration (STARmap)", "Welcome to GraphPCA's documentation!"], "terms": {"graphpca": [0, 3], "packag": 0, "i": [0, 1, 2, 4], "mainli": 0, "base": [0, 2], "python": 0, "numpi": [0, 1, 2, 3], "panda": [0, 1, 2, 3], "matplotlib": [0, 3], "scipi": [0, 3], "scikit": 0, "learn": 0, "networkx": 0, "scanpi": [0, 1, 2], "squidpi": [0, 1, 2, 3], "via": 0, "pypi": 0, "us": [0, 1, 3], "pip": 0, "st": [0, 2], "here": [1, 2, 3], "we": [1, 2, 3], "sampl": [1, 4], "id": 1, "151673": 1, "from": [1, 2, 3], "demostr": 1, "can": 1, "download": [1, 2], "origin": [1, 2, 3], "studi": [1, 2], "spatiallibd": 1, "http": 1, "research": 1, "libd": 1, "org": 1, "index": [1, 2, 3], "html": 1, "import": [1, 2, 3], "sg": [1, 2, 3], "sc": [1, 2, 3], "anndata": [1, 2, 3], "ad": [1, 2, 3], "np": [1, 2, 3], "pd": [1, 2, 3], "sq": [1, 2, 3], "sklearn": [1, 2, 3], "kmean": [1, 2, 3], "metric": [1, 2, 3], "pairwise_dist": [1, 2, 3], "pair": [1, 2, 3], "adjusted_rand_scor": [1, 2, 3], "ari_scor": [1, 2, 3], "2": [1, 3, 4], "151507": 1, "151508": 1, "151509": 1, "151510": 1, "151669": 1, "151670": 1, "151671": 1, "151672": 1, "151674": 1, "151675": 1, "151676": 1, "bestk": 1, "7": [1, 2, 3], "5": [1, 2, 3], "data_path": [1, 2, 3], "data": 1, "save_path": [1, 2, 3], "result": [1, 2, 3], "path_gt": 1, "groundtruth": [1, 2, 3], "spatialde_clust": 1, "cluster_labels_": 1, "sample_id": [1, 2, 3], "8": [1, 2, 3], "pca_compon": [1, 2, 3], "50": [1, 2, 3], "befor": [1, 2], "assum": [1, 2], "gene": [1, 2], "express": [1, 2, 3], "count": [1, 2], "have": [1, 2], "alreadi": [1, 2], "been": [1, 2], "analyt": [1, 2], "pearson": [1, 2], "residu": [1, 2], "propos": [1, 2], "laus": [1, 2], "et": [1, 2], "al": [1, 2], "further": [1, 2], "scale": [1, 2, 3], "each": [1, 2], "0": [1, 2, 3], "mean": [1, 2], "unit": [1, 2], "standard": [1, 2], "deviat": [1, 2], "Then": 1, "select": 1, "top": 1, "3": [1, 2, 4], "000": 1, "spatial": [1, 2], "variabl": 1, "spark": 1, "adata": [1, 2, 3], "read": 1, "sample_data": 1, "h5ad": 1, "pp": [1, 2, 3], "filter_gen": [1, 2, 3], "min_cel": [1, 2, 3], "20": [1, 2, 3], "experiment": [1, 2, 3], "normalize_pearson_residu": [1, 2, 3], "svg_list": 1, "read_csv": [1, 2, 3], "spatialpca_data_preprocess": 1, "_svg": 1, "csv": [1, 2, 3], "index_col": [1, 2, 3], "var": [1, 2], "gene_id": 1, "isin": 1, "x": [1, 2, 3], "4": [1, 2, 3], "sep": 1, "header": 1, "na_filt": 1, "fals": [1, 3], "arrai": [1, 2, 3], "ground_truth": 1, "ob": [1, 2, 3], "x_arrai": [1, 2, 3], "array_row": 1, "tolist": [1, 2, 3], "y_arrai": [1, 2, 3], "array_col": 1, "locat": [1, 2, 3, 4], "t": [1, 2, 3], "astyp": [1, 2, 3], "float32": [1, 2, 3], "z": [1, 2, 3], "w": [1, 2], "run_gpca": [1, 2, 3], "n_compon": [1, 2, 3], "method": [1, 2, 3, 4], "knn": [1, 2, 3], "platform": 1, "_lambda": [1, 2, 3], "save_reconstruct": [1, 2, 3], "true": [1, 2, 3], "obsm": [1, 2, 3], "print": [1, 2, 3], "shape": [1, 2, 3], "3639": 1, "estim": [1, 2, 3], "n_cluster": [1, 2, 3], "re": [1, 2, 3], "fit": [1, 2, 3], "lable_pr": [1, 2, 3], "labels_": [1, 2, 3], "gpca_pr": [1, 2, 3], "categori": [1, 2, 3], "refined_pr": [1, 2, 3], "refin": [1, 2, 3], "pred": [1, 2, 3], "di": [1, 2, 3], "hexagon": 1, "5311286908464182": 1, "6": [1, 2, 3], "pl": [1, 2, 3], "spatial_scatt": [1, 2], "color": [1, 2, 3], "object": [1, 2], "n_ob": [1, 2, 3], "n_var": [1, 2, 3], "3000": 1, "39": [1, 2, 3], "in_tissu": 1, "feature_typ": 1, "genom": 1, "n_cell": [1, 2], "std": [1, 2], "un": [1, 2, 3], "pearson_residuals_norm": [1, 2], "groundtruth_color": 1, "gpca_pred_color": [1, 3], "layer": [1, 2, 3], "graphpca_rex": [1, 2], "atp2b4": 1, "rasgrf2": 1, "lamp5": 1, "nefh": 1, "ntng2": 1, "b3galt2": 1, "ncol": 1, "axis_label": 1, "size": [1, 2, 3], "colorbar": 1, "9": [1, 2, 3], "10": [1, 2, 3], "na": 1, "11": [1, 2, 3], "heatmap": 1, "var_nam": 1, "groupbi": 1, "cmap": 1, "viridi": [1, 2], "dendrogram": 1, "swap_ax": 1, "figsiz": [1, 2, 3], "13": [1, 2], "14": [1, 2], "gpca_pc": [1, 2], "datafram": [1, 2], "to_df": [1, 2], "column": [1, 2], "pc_": [1, 2], "str": [1, 2, 3], "arang": [1, 2, 3], "15": [1, 2], "concat": [1, 2], "axi": [1, 2], "16": 1, "set_figure_param": [1, 2], "color_map": [1, 2], "17": 1, "pc_0": [1, 2], "pc_1": [1, 2], "pc_2": [1, 2], "18": 1, "gpca_w": [1, 2], "19": 1, "top_5_row": 1, "nlargest": [1, 2], "appli": 2, "high": 2, "resolut": 2, "imag": 2, "specif": 2, "mous": 2, "medial": 2, "prefront": 2, "cortex": 2, "gener": [2, 3], "annot": [2, 3], "both": 2, "domain": 2, "cell": [2, 3], "level": 2, "ground": 2, "truth": 2, "evalu": 2, "1": [2, 3, 4], "starmap_expr": [2, 3], "starmap_loc": [2, 3], "starmap_groundtruth": 2, "copi": [2, 3], "int": [2, 3], "1049": 2, "166": 2, "y": [2, 3], "var_names_make_uniqu": [2, 3], "n_neighbor": [2, 3], "neighbor_num": [2, 3], "8682823215084668": 2, "seri": [2, 3], "match_cluster_label": [2, 3], "valu": [2, 3], "dtype": [2, 3], "color_list": 2, "e64b35ff": [2, 3], "4dbbd5ff": [2, 3], "00a087ff": [2, 3], "3c5488ff": [2, 3], "make_scatterplot": 2, "column_nam": 2, "coord_x": 2, "coord_i": 2, "use_titl": 2, "only_point": 2, "200": [2, 3], "figsize_width": 2, "figsize_height": 2, "del": 2, "12": [2, 3], "none": [2, 3], "warn": 2, "pleas": 2, "specifi": 2, "valid": [2, 3], "library_id": 2, "perman": 2, "top_3_row": 2, "ab": 2, "capabl": 3, "our": 3, "model": 3, "extens": 3, "through": 3, "aggreg": 3, "neighborhood": 3, "graph": [3, 4], "profil": 3, "one": 3, "matrix": 3, "To": 3, "achiev": 3, "besid": 3, "bz5": 3, "tutorial2": 3, "obtain": 3, "two": 3, "addit": 3, "tissu": [3, 4], "section": 3, "bz9": 3, "bz14": 3, "differ": 3, "mice": 3, "all": 3, "ar": 3, "four": 3, "cortic": 3, "l1": 3, "l2": 3, "l5": 3, "l6": 3, "accord": 3, "public": 3, "neighbor": 3, "kneighbors_graph": 3, "slice_ind": 3, "batch_list": 3, "adj_list": 3, "starmap_expr_": 3, "starmap_loc_": 3, "starmap_groundtruth_": 3, "make": 3, "spot": 3, "name": 3, "uniqu": 3, "obs_nam": 3, "_": 3, "construct": 3, "asarrai": 3, "euclidean": 3, "metric_param": 3, "include_self": 3, "adj": 3, "normal": 3, "append": 3, "adata_concat": 3, "label": 3, "slice_nam": 3, "kei": 3, "batch_nam": 3, "3190": 3, "159": 3, "adj_concat": 3, "todens": 3, "batch_id": 3, "rang": 3, "len": 3, "linalg": 3, "block_diag": 3, "edgelist": 3, "nonzero": 3, "spars": 3, "csr_matrix": 3, "7636451157316565": 3, "section_id": 3, "bb": 3, "pyplot": 3, "plt": 3, "spot_siz": 3, "title_s": 3, "ref_color": 3, "ari_list": 3, "round": 3, "fig": 3, "ax": 3, "subplot": 3, "gridspec_kw": 3, "wspace": 3, "05": 3, "hspace": 3, "_sc_0": 3, "img_kei": 3, "titl": 3, "legend_loc": 3, "legend_fonts": 3, "show": 3, "frameon": 3, "set_titl": 3, "ari": 3, "_sc_1": 3, "_sc_2": 3, "instal": 4, "tutori": 4, "10x": 4, "visium": 4, "dataset": 4, "dlpfc": 4, "starmap": 4, "mpfc": 4, "multi": 4, "integr": 4, "novel": 4, "constrain": 4, "quasi": 4, "linear": 4, "tailor": 4, "It": 4, "leverag": 4, "strength": 4, "graphic": 4, "regular": 4, "princip": 4, "compon": 4, "analysi": 4, "pca": 4, "extract": 4, "low": 4, "dimension": 4, "embed": 4, "inform": 4, "time": 4, "complex": 4, "The": 4, "substanti": 4, "power": 4, "boost": 4, "enabl": 4, "fertil": 4, "variou": 4, "downstream": 4, "task": 4, "analys": 4, "provid": 4, "more": 4, "precis": 4, "insight": 4, "cellular": 4, "landscap": 4}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"instal": 0, "softwar": 0, "depend": 0, "tutori": [1, 2, 3], "1": 1, "10x": 1, "visium": 1, "dataset": 1, "dlpfc": 1, "load": [1, 2, 3], "packag": [1, 2, 3], "set": [1, 2], "paramet": [1, 2], "preprocess": [1, 2], "perform": [1, 2, 3], "graphpca": [1, 2, 4], "cluster": [1, 2, 3], "visual": [1, 2, 3], "denos": 1, "coexpress": [1, 2], "modul": [1, 2], "2": 2, "starmap": [2, 3], "data": [2, 3, 4], "mpfc": 2, "3": 3, "multi": 3, "sampl": 3, "integr": 3, "concat": 3, "scanpi": 3, "object": 3, "multipl": 3, "slice": 3, "spatial": [3, 4], "network": 3, "graphpca_multi": 3, "welcom": 4, "": 4, "document": 4, "fast": 4, "interpret": 4, "dimens": 4, "reduct": 4, "algorithm": 4, "transcriptom": 4, "content": 4, "overview": 4}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "nbsphinx": 4, "sphinx": 60}, "alltitles": {"Installation": [[0, "installation"]], "Software dependencies": [[0, "software-dependencies"]], "installation": [[0, "id1"]], "Tutorial 1: 10X Visium dataset (DLPFC)": [[1, "Tutorial-1:-10X-Visium-dataset-(DLPFC)"]], "Load packages": [[1, "Load-packages"], [2, "Load-packages"], [3, "Load-packages"]], "Setting parameters": [[1, "Setting-parameters"], [2, "Setting-parameters"]], "Preprocessing": [[1, "Preprocessing"], [2, "Preprocessing"]], "Perform GraphPCA": [[1, "Perform-GraphPCA"], [2, "Perform-GraphPCA"]], "Clustering": [[1, "Clustering"], [2, "Clustering"], [3, "Clustering"]], "Visualization": [[1, "Visualization"], [2, "Visualization"], [3, "Visualization"]], "Denosing": [[1, "Denosing"]], "Coexpression module": [[1, "Coexpression-module"], [2, "Coexpression-module"]], "Tutorial 2: STARmap data (mPFC)": [[2, "Tutorial-2:-STARmap-data-(mPFC)"]], "Tutorial 3: Multi-sample integration (STARmap)": [[3, "Tutorial-3:-Multi-sample-integration-(STARmap)"]], "Load data": [[3, "Load-data"]], "Concat the scanpy objects for multiple slices": [[3, "Concat-the-scanpy-objects-for-multiple-slices"]], "Concat the spatial network for multiple slices": [[3, "Concat-the-spatial-network-for-multiple-slices"]], "Perform GraphPCA_multi": [[3, "Perform-GraphPCA_multi"]], "Welcome to GraphPCA's documentation!": [[4, "welcome-to-graphpca-s-documentation"]], "GraphPCA \u2013 a fast and interpretable dimension reduction algorithm for spatial transcriptomics data.": [[4, "graphpca-a-fast-and-interpretable-dimension-reduction-algorithm-for-spatial-transcriptomics-data"]], "Contents:": [[4, null]], "Overview": [[4, "overview"]]}, "indexentries": {}})